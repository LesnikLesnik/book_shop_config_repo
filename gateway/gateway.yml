spring:
  cloud:
    gateway:
      routes:
        - id: account-service
          uri: lb://account-service
          predicates:
            - Path=/account-service/**
          filters:
            - RewritePath=/account-service(?<segment>/.*), $1
            - AddResponseHeader=X-Forwarded-Prefix, /account-service
        - id: bill-service
          uri: lb://bill-service
          predicates:
            - Path=/bill-service/**
          filters:
            - RewritePath=/bill-service(?<segment>/.*), $1
            - AddResponseHeader=X-Forwarded-Prefix, /bill-service
        - id: book-service
          uri: lb://book-service
          predicates:
            - Path=/book-service/**
          filters:
            - RewritePath=/book-service(?<segment>/.*), $1
            - AddResponseHeader=X-Forwarded-Prefix, /book-service
        # Добавляем маршрут для общего доступа к Swagger UI
        - id: swagger-ui
          uri: http://localhost:8989
          predicates:
            - Path=/swagger-ui.html, /swagger-ui/**  # Swagger UI доступен по этим путям
          filters:
            - RewritePath=/swagger-ui(?<segment>/.*), /account-service/swagger-ui$1  # Переписываем на account-service


server:
  port: 8989
